# 综合复盘软件详细设计文档

## 项目概述

综合复盘软件是一个专业的PCAP数据回放分析系统，主要用于军事训练、演习、网络攻防演练等场景的数据回放和分析。系统能够加载、解析和回放PCAP网络数据包文件，通过时间轴控制、地图可视化、事件分析等功能，帮助用户深入分析网络通信过程，识别关键事件，评估训练效果。

系统的主要业务价值体现在四个方面：训练复盘功能支持军事训练和演习数据的完整回放，便于分析训练过程和效果；事件分析功能通过时间轴和事件标记，快速定位和分析关键网络事件；可视化展示功能结合地图显示和平台轨迹，直观展示网络通信和活动情况；数据管理功能提供完整的工程和数据集管理，支持大规模数据的高效处理。

技术架构采用前后端分离设计，前端使用Nuxt3 + Vue3 + TypeScript + TailwindCSS + MapLibre GL构建用户界面，后端使用Rust + Tauri + Tokio提供高性能数据处理能力，支持PCAP + PIDX索引文件格式，集成MapLibre GL地图引擎实现地理信息可视化。

## 业务模块设计

### 工程管理模块

| 功能模块       | 子功能         | 功能描述                             | 实现状态    | 优先级 |
| -------------- | -------------- | ------------------------------------ | ----------- | ------ |
| **工程管理**   | 新建工程       | 创建新的工程目录和基础结构           | 🔄 待实现   | 高     |
|                | 打开工程       | 选择并打开工程目录，加载工程元数据   | ✅ 已实现   | 高     |
|                | 关闭工程       | 关闭当前工程，清理资源               | ✅ 已实现   | 高     |
|                | 显示工程信息   | 显示工程名称、路径、文件数量、时长等 | ✅ 已实现   | 高     |
|                | 扫描工程结构   | 扫描工程目录结构，识别数据集         | ✅ 已实现   | 高     |
| **数据集管理** | 创建数据集     | 在工程中创建新的数据集目录           | ✅ 已实现   | 中     |
|                | 导入数据集     | 导入外部PCAP文件到指定数据集         | 🔄 待实现   | 高     |
|                | 移除数据集     | 删除指定的数据集及其所有文件         | 🔄 待实现   | 中     |
|                | 显示数据集列表 | 显示工程中所有数据集                 | ✅ 已实现   | 高     |
|                | 选择数据集     | 选择要回放的数据集                   | ✅ 已实现   | 高     |
|                | 显示数据集统计 | 显示数据集文件数量、大小等信息       | 🔄 部分实现 | 中     |

### 数据回放模块

| 功能模块       | 子功能       | 功能描述                 | 实现状态  | 优先级 |
| -------------- | ------------ | ------------------------ | --------- | ------ |
| **回放控制**   | 开始回放     | 开始播放选定的数据集     | ✅ 已实现 | 高     |
|                | 暂停回放     | 暂停当前回放             | ✅ 已实现 | 高     |
|                | 停止回放     | 停止回放并重置到开始位置 | ✅ 已实现 | 高     |
|                | 跳转定位     | 跳转到指定时间点         | ✅ 已实现 | 高     |
|                | 设置倍速     | 设置回放速度（1x-16x）   | ✅ 已实现 | 高     |
| **时间轴管理** | 显示时间轴   | 显示回放时间轴和进度     | ✅ 已实现 | 高     |
|                | 显示平台轨道 | 显示各平台的活动时间轨道 | ✅ 已实现 | 高     |
|                | 标记事件     | 在时间轴上标记重要事件   | ✅ 已实现 | 中     |
|                | 格式化时间   | 智能时间显示（跨天处理） | ✅ 已实现 | 中     |
| **状态管理**   | 管理回放状态 | 管理播放、暂停、停止状态 | ✅ 已实现 | 高     |
|                | 跟踪进度     | 实时跟踪回放进度         | ✅ 已实现 | 高     |
|                | 同步数据     | 前后端数据状态同步       | ✅ 已实现 | 高     |

### 地图显示模块

| 功能模块     | 子功能         | 功能描述               | 实现状态  | 优先级 |
| ------------ | -------------- | ---------------------- | --------- | ------ |
| **地图引擎** | 显示地图容器   | 提供地图显示容器       | ✅ 已实现 | 高     |
|              | 加载地图瓦片   | 加载和显示地图瓦片     | 🔄 待实现 | 高     |
|              | 支持矢量瓦片   | 支持MVT矢量瓦片        | 🔄 待实现 | 中     |
|              | 地图交互       | 缩放、平移、旋转等操作 | 🔄 待实现 | 高     |
| **地理数据** | 加载GeoJSON    | 加载和显示GeoJSON数据  | 🔄 待实现 | 高     |
|              | 转换坐标       | 坐标系转换和数据变换   | 🔄 待实现 | 中     |
|              | 地理编码       | 地址和坐标互转         | 🔄 待实现 | 低     |
| **地图工具** | 显示地图工具条 | 提供地图操作工具       | ✅ 已实现 | 中     |
|              | 显示地图图例   | 显示地图图例和说明     | ✅ 已实现 | 中     |
|              | 显示坐标       | 实时显示鼠标位置坐标   | 🔄 待实现 | 中     |

### 数据可视化模块

| 功能模块     | 子功能       | 功能描述                   | 实现状态  | 优先级 |
| ------------ | ------------ | -------------------------- | --------- | ------ |
| **事件列表** | 显示事件列表 | 显示回放过程中的事件列表   | ✅ 已实现 | 高     |
|              | 过滤事件     | 按类型、时间等条件过滤事件 | 🔄 待实现 | 中     |
|              | 显示事件详情 | 显示事件的详细信息         | 🔄 待实现 | 中     |
|              | 搜索事件     | 搜索特定事件               | 🔄 待实现 | 低     |
| **环境信息** | 显示环境数据 | 显示环境相关信息           | ✅ 已实现 | 中     |
|              | 显示天气信息 | 显示天气、海况等数据       | 🔄 待实现 | 中     |
|              | 显示时间信息 | 显示当前回放时间信息       | ✅ 已实现 | 高     |
| **目标信息** | 显示目标列表 | 显示参与平台/目标列表      | 🔄 待实现 | 高     |
|              | 显示目标详情 | 显示目标的详细信息         | 🔄 待实现 | 中     |
|              | 显示目标轨迹 | 显示目标的运动轨迹         | 🔄 待实现 | 高     |
|              | 显示目标状态 | 显示目标的实时状态         | 🔄 待实现 | 中     |

### 回放设置模块

| 功能模块     | 子功能       | 功能描述           | 实现状态  | 优先级 |
| ------------ | ------------ | ------------------ | --------- | ------ |
| **回放配置** | 设置回放参数 | 设置回放相关参数   | ✅ 已实现 | 高     |
|              | 设置数据过滤 | 设置数据过滤条件   | 🔄 待实现 | 中     |
|              | 设置显示选项 | 设置显示相关选项   | 🔄 待实现 | 中     |
| **网络配置** | 配置UDP发送  | 配置UDP数据发送    | 🔄 待实现 | 高     |
|              | 设置广播参数 | 设置广播、组播参数 | 🔄 待实现 | 中     |
|              | 测试网络连接 | 测试网络连接状态   | 🔄 待实现 | 中     |
| **系统设置** | 设置界面选项 | 设置界面显示选项   | 🔄 待实现 | 低     |
|              | 设置性能参数 | 设置性能相关参数   | 🔄 待实现 | 中     |
|              | 设置日志级别 | 设置日志级别和输出 | 🔄 待实现 | 低     |

### 数据管理模块

| 功能模块     | 子功能       | 功能描述             | 实现状态  | 优先级 |
| ------------ | ------------ | -------------------- | --------- | ------ |
| **PCAP处理** | 读取PCAP文件 | 高性能PCAP文件读取   | ✅ 已实现 | 高     |
|              | 写入PCAP文件 | PCAP文件写入功能     | ✅ 已实现 | 高     |
|              | 解析PCAP格式 | PCAP格式解析和验证   | ✅ 已实现 | 高     |
|              | 处理数据包   | 数据包解析和处理     | ✅ 已实现 | 高     |
| **索引系统** | 生成索引     | 自动生成PIDX索引文件 | ✅ 已实现 | 高     |
|              | 读取索引     | 高性能索引文件读取   | ✅ 已实现 | 高     |
|              | 管理索引     | 索引文件的增删改查   | ✅ 已实现 | 高     |
|              | 优化索引     | 索引性能优化         | 🔄 待实现 | 中     |
| **缓存管理** | 缓存文件数据 | 文件数据缓存机制     | ✅ 已实现 | 高     |
|              | 优化内存使用 | 内存使用优化         | 🔄 待实现 | 中     |
|              | 管理缓存策略 | 智能缓存策略         | 🔄 待实现 | 中     |
